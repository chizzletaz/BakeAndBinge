{% extends "base.html" %}
{% block content %}

<div class="container align-center">
    <h2>Recipes</h2>

    <!-- Categories display only on large and extra large size > 992px -->
    <div class="row">
        <div class="center-align hide-on-med-and-down pb">
            <a href="{{ url_for('recipes') }}" class="waves-effect waves-light pink accent-1 btn">All</a>
            {% for category in categories %}
            <a href="{{ url_for('recipes_filter', category_name=category.category_name) }}"
                class="waves-effect waves-light pink accent-1 btn">{{ category.category_name }}</a>
            {% endfor %}
        </div>

        <div class="row">
            <!-- Categories display only on small and medium size < 992px -->
            <div class="col s12 m4 center-align hide-on-med-and-up show-on-medium-and-down">
                <!-- Dropdown Trigger -->
                <a class='dropdown-trigger btn btn-large' href='#' data-target='dropdownCat'>Categories</a>

                <!-- Dropdown Structure -->
                <ul id='dropdownCat' class='dropdown-content'>
                    <li><a class="black-text hvr-ufc" href="{{ url_for('recipes') }}">All recipes</a></li>
                    <li><a class="black-text hvr-ufc"
                            href="{{ url_for('recipes_filter', category_name=recipes.category_name) }}">Bread</a></li>
                    <li><a class="black-text hvr-ufc" href="#">Cake</a></li>
                    <li><a class="black-text hvr-ufc" href="#">Cookies</a></li>
                    <li><a class="black-text hvr-ufc" href="#">Muffins</a></li>
                    <li><a class="black-text hvr-ufc" href="#">Pie</a></li>
                </ul>
            </div>
            <!-- search and reset buttons -->
            <div class="searchbar col s12 m8 l12">
                <form action="{{ url_for('search') }}" method="POST">
                    <div class="row">
                        <div class="input-field col s12 m8 right-align">
                            <input placeholder="What do you want to bake today?" id="query" name="query" type="text"
                                class="validate">
                        </div>
                        <div class="col s12 m4 center-align">
                            <button type="submit" class="waves-effect waves-light blue btn"><i
                                    class="fas fa-search"></i></button>
                            <a href="{{ url_for('recipes') }}"
                                class="waves-effect waves-light blue-grey darken-3 btn"><i class="fas fa-times"></i></a>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- recipes overview -->
    {% if recipes|length > 0 %}
    <div class="row">
        {% for recipe in recipes %}
        <div class="col s12 m6 l4">
            <div class="card z-depth-2 hover">
                <div class="card-image">
                    <img src="{{ recipe.recipe_image }}" alt="{{ recipe.recipe_title }}">
                    <p>By: {{ recipe.created_by | capitalize }}</p>
                </div>
                <div class="divider"></div>     <!-- from Materialize: 1 pixel lines that helps break up the content -->
                <div class="card-content center-align pt0">
                    <h5><strong>{{ recipe.recipe_title | capitalize }}</strong></h5>
                </div>
                <div class="col s12 card-content grey-bb pt0">
                    <blockquote>{{ recipe.recipe_description }}</blockquote>
                </div>
                <div class="row">
                    <div class="card-content indications">
                        <ul class="col collection">
                            <li class="collection-item">
                                <p><i class="far fa-clock"></i> {{ recipe.total_time }}</p>
                            </li>
                        </ul>
                        <ul class="col collection">
                            <li class="collection-item">
                                <p><i class="fas fa-user-friends"></i> {{ recipe.servings }}</p>
                            </li>
                        </ul>
                        <ul class="col collection">
                            <li class="collection-item">
                                <p><i class="fas fa-list-ul"></i> {{ recipe.category_name | capitalize }}</p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="card-action center-align">
                    <a class="btn pink lighten-3" href="{{ url_for('recipe', recipe_id=recipe._id) }}">Go to
                        recipe</a>
                </div>
                {% if session.user|lower == recipe.created_by|lower %}
                <div class="card-action">
                    <a class="btn-small blue-grey lighten-4 black-text gb"
                        href="{{ url_for('edit_recipe', recipe_id=recipe._id) }}">Edit</a>
                    <!-- Modal Trigger for confirmation -->
                    <a class="btn-small blue-grey lighten-4 black-text right rb modal-trigger" href="#modal1">Delete</a>
                </div>

                {% endif %}
            </div>
        </div>
        <!-- Modal Structure for confirmation-->
        <div id="modal1" class="modal">
            <div class="modal-content center-align">
                <h5>Are you sure you want to delete this recipe?</h5>
            </div>
            <div class="modal-footer">
                <a href="{{ url_for('recipes') }}" class="modal-close waves-effect btn-small left">No</a>
                <a href="{{ url_for('delete_recipe', recipe_id=recipe._id) }}"
                    class="modal-close waves-effect btn-small">Yes</a>
            </div>
        </div>
        {% endfor %}

    </div>
    {% else %}
    <h4 class="red-text center-align">Sorry, no results were found</h4>
    {% endif %}
</div>


{% endblock %}